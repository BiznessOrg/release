# Contributor:
# Maintainer:
pkgname=tablet-xournalpp
pkgver=0.0.6
pkgrel=0
pkgdesc="xournalpp tablet yeah"
url="localhost"
arch="all"
license="LGPL-2.0-or-later"
depends="adwaita-icon-theme"
makedepends="
	cmake
	glib-dev
	gtest-dev
	gtk+3.0-dev
	gtksourceview4-dev
	help2man
	librsvg-dev
	libsndfile-dev
	libx11-dev
	libxi-dev
	libxml2-dev
	libzip-dev
	lsb-release
	lua5.4-dev
	poppler-dev
	portaudio-dev
	samurai
	"
options="!check"

build() {
	ln -s $HOME/xournalpp "$srcdir/$pkgname-$pkgver"
	cd "$srcdir/$pkgname-$pkgver"

	if [ "$CBUILD" != "$CHOST" ]; then
		CMAKE_CROSSOPTS="-DCMAKE_SYSTEM_NAME=Linux -DCMAKE_HOST_SYSTEM_NAME=Linux"
	fi

	LDFLAGS="$LDFLAGS -Wl,-z,stack-size=2097152" \
	cmake -B build \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_SHARED_LIBS=True \
		-DLUA_LIBRARIES="/usr/lib/lua5.4/liblua.so" \
		-DCMAKE_BUILD_TYPE=MinSizeRel \
		$CMAKE_CROSSOPTS
	cmake --build build --target all translations
}

package() {
	DESTDIR="$pkgdir" cmake --install "$srcdir/$pkgname-$pkgver/build"
}

